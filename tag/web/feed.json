{
    "version": "https://jsonfeed.org/version/1",
    "title": "麻婆酱 • All posts by \"web\" tag",
    "description": "种一棵树的最好时间是十年前，其次是现在",
    "home_page_url": "https://mapo.io",
    "items": [
        {
            "id": "https://mapo.io/2019/03/26/website-darkmode-on-macos/",
            "url": "https://mapo.io/2019/03/26/website-darkmode-on-macos/",
            "title": "让你的网站支持macOS和IOS的深色模式(测试文章)",
            "date_published": "2019-03-26T12:52:01.000Z",
            "content_html": "<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>如果你在使用 macOS 10.14.4 或者之后的系统，在系统内开启深色模式，打开 Safari 浏览器，你会发现我的博客变成了暗黑版本。</p>\n<p class=\"success\">本文发表于2019-03-26，而在2019-06-04凌晨，Apple 发布了 IOS 13，本文所说的方法也同时适用于 IOS Safari</p>\n\n<p class=\"success\">2019-08-08 今天突然发现 Chrome 也支持了</p>\n\n<p>深色模式（Dark Mode）是 Apple 在 macOS Mojave 上全新推出的一项功能，macOS 内置的 App 能完美支持，凭借着易用的接口，越来越多的第三方 App 已经进行了适配，可大家使用最多的浏览器却没能很好的支持，虽然你可以使用 Safari 的阅读视图浏览深色模式下的页面内容，但体验终归没有网站自身支持的好。</p>\n<p>原因主要有两个，一是浏览器没有给出让开发者适配的接口，二是网站设计并不统一，强行进入深色模式会破坏页面的设计和内容的可读性。</p>\n<p>于是经过几次的升级，macOS 终于在 Safari 12.1 中加入了一个新的媒体查询 <code>prefers-color-scheme</code>，并且 FireFox 67 也开始进行支持，其他浏览器的具体支持情况可在这里查看：<a href=\"https://caniuse.com/#search=prefers-color-scheme\" target=\"_blank\" rel=\"noopener\">https://caniuse.com/#search=prefers-color-scheme</a></p>\n<h2 id=\"数学公式测试\"><a href=\"#数学公式测试\" class=\"headerlink\" title=\"数学公式测试\"></a>数学公式测试</h2><p>$$f(x) = a_1x^n + a_2x^{n-1} + a_3x^{n-2}$$</p>\n<pre class=\"mermaid\">sequenceDiagram\n    participant Alice\n    participant Bob\n    Alice->>John: Hello John, how are you?\n    loop Healthcheck\n        John->>John: Fight against hypochondria\n    end\n    Note right of John: Rational thoughts <br/>prevail...\n    John-->>Alice: Great!\n    John->>Bob: How about you?\n    Bob-->>John: Jolly good!</pre>\n\n<h2 id=\"简单使用\"><a href=\"#简单使用\" class=\"headerlink\" title=\"简单使用\"></a>简单使用</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Name:   prefers-color-scheme</span><br><span class=\"line\">For:    @media</span><br><span class=\"line\">Value:  no-preference | light | dark</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>no-preference：无颜色偏好</li>\n<li>light：浅色模式</li>\n<li>dark：深色模式</li>\n</ul>\n<p>和你是用的其他媒体查询一样，用起来很简单</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">@media</span> (<span class=\"attribute\">prefers-color-scheme:</span> light) &#123;</span><br><span class=\"line\">    <span class=\"comment\">/* 浅色模式样式 */</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@media</span> (<span class=\"attribute\">prefers-color-scheme:</span> dark) &#123;</span><br><span class=\"line\">    <span class=\"comment\">/* 深色模式样式 */</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>默认都是浅色模式的，所以我们只写深色模式的样式就行</p>\n<h2 id=\"使用CSS变量\"><a href=\"#使用CSS变量\" class=\"headerlink\" title=\"使用CSS变量\"></a>使用CSS变量</h2><p>现在也页面都会涉及到大量的样式，要适配深色模式，最好使用变量。</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-pseudo\">:root</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">--background-color</span>: <span class=\"number\">#FFFFFF</span>;</span><br><span class=\"line\">  <span class=\"attribute\">--content-color</span>: <span class=\"number\">#15171A</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">@media</span> (<span class=\"attribute\">prefers-color-scheme:</span> dark) &#123;</span><br><span class=\"line\">  <span class=\"selector-pseudo\">:root</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">--background-color</span>: <span class=\"number\">#222</span>;</span><br><span class=\"line\">    <span class=\"attribute\">--content-color</span>: <span class=\"number\">#dfdfdf</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-class\">.main-page</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">background</span>: <span class=\"built_in\">var</span>(--background-color);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"selector-class\">.full-content</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">color</span>: <span class=\"built_in\">var</span>(--content-color)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>上面的例子中，只定义了几个颜色相关的样式，事实上你可以跟其他媒体查询一样，定义其他的样式，让你的深色模式有更多不同的布局。</p>\n<h2 id=\"颜色\"><a href=\"#颜色\" class=\"headerlink\" title=\"颜色\"></a>颜色</h2><p>颜色这个就看自己喜欢了，不过要注意一点，如果你是使用 macOS 内置 App 的配色，强调色会改变一些基础配色，比如强调色不是石墨色的时候，背景颜色会变得比较暖。</p>\n<p>在设置颜色的时候，要保证内容的可读性，我们需要将文本和背景的颜色对比度保持在一个安全的范围内，这时候你需要用到这个工具： <a href=\"https://github.com/leaverou/contrast-ratio\" target=\"_blank\" rel=\"noopener\">https://github.com/leaverou/contrast-ratio</a></p>\n<h2 id=\"图片\"><a href=\"#图片\" class=\"headerlink\" title=\"图片\"></a>图片</h2><p>在写好颜色相关的样式之后，你会发现页面上的图片变得很刺眼，这时你可以降低一下图片的透明度，具体降多少也是看你背景设置的色深，另外可以设置一下鼠标悬停时恢复透明度，这样能有更好的体验。</p>\n<p>我用的 blazy 懒加载，所以是这样设置的</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">@media</span> (<span class=\"attribute\">prefers-color-scheme:</span> dark) &#123;</span><br><span class=\"line\">    <span class=\"selector-class\">.b-lazy</span><span class=\"selector-class\">.b-loaded</span> &#123;</span><br><span class=\"line\">        <span class=\"attribute\">opacity</span>: .<span class=\"number\">9</span>;</span><br><span class=\"line\">        <span class=\"attribute\">transition</span>: opacity .<span class=\"number\">5s</span> ease-in-out;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"selector-class\">.b-lazy</span><span class=\"selector-class\">.b-loaded</span><span class=\"selector-pseudo\">:hover</span> &#123;</span><br><span class=\"line\">        <span class=\"attribute\">opacity</span>: <span class=\"number\">1</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"后话\"><a href=\"#后话\" class=\"headerlink\" title=\"后话\"></a>后话</h2><p>在深色模式推出之后，得到了不错的反响，我认为 IOS 13 会引入一定深色模式。另外，Windows 也有“暗”模式，相信越来越多的应用会进行这样深色模式的适配，在 macOS 10.14.4 升级之后，我在第一时间进行了博客主题更新，只有大家都用了这个新的媒体查询，才会推动其他平台和浏览器的适配，好东西值得推崇。</p>\n<blockquote>\n<p>本文章发表于底噪博客 <a href=\"https://zhih.me\" target=\"_blank\" rel=\"noopener\">https://zhih.me</a> , 转载请注明<br>直接偷的人，你打球真蔡</p>\n</blockquote>\n",
            "tags": [
                "web",
                "macOS"
            ]
        }
    ]
}